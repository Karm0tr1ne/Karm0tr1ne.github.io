<!DOCTYPE html><html lang="ch"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Karmotrine"><meta name="copyright" content="Karmotrine"><meta name="generator" content="Hexo 6.0.0"><meta name="theme" content="hexo-theme-yun"><title>在Unity中不使用任何插件制作角色对话框系统 | Utopia</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link class="aplayer-style-marker" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script class="aplayer-script-marker" src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" defer></script><script class="meting-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js" defer></script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"example.com","root":"/","title":["し","い","な","の","博","客"],"version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="Utopia" type="application/atom+xml"><meta name="description" content="在众多RPG等游戏中，对话框系统显然属于不可或缺的一部分。玩家通过对话了解剧情以及接下来的主线。可以说，对话系统就是RPG游戏的灵魂（bushi,而这个文章介绍的对话系统可以在无需插件并且完成对话系统基本功能的同时完成以下三点内容： 1.剧情内容只用按照规律写在txt文件里 2.可以选择跳过，自动播放或者手动播放 3.文字会一个一个显示，而不是整句话蹦出来 撒，那我们开始把（ 搭建对话框​">
<meta property="og:type" content="article">
<meta property="og:title" content="在Unity中不使用任何插件制作角色对话框系统">
<meta property="og:url" content="http://example.com/2021/04/08/%E5%9C%A8Unity%E4%B8%AD%E4%B8%8D%E4%BD%BF%E7%94%A8%E4%BB%BB%E4%BD%95%E6%8F%92%E4%BB%B6%E5%88%B6%E4%BD%9C%E8%A7%92%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%B3%BB%E7%BB%9F/index.html">
<meta property="og:site_name" content="Utopia">
<meta property="og:description" content="在众多RPG等游戏中，对话框系统显然属于不可或缺的一部分。玩家通过对话了解剧情以及接下来的主线。可以说，对话系统就是RPG游戏的灵魂（bushi,而这个文章介绍的对话系统可以在无需插件并且完成对话系统基本功能的同时完成以下三点内容： 1.剧情内容只用按照规律写在txt文件里 2.可以选择跳过，自动播放或者手动播放 3.文字会一个一个显示，而不是整句话蹦出来 撒，那我们开始把（ 搭建对话框​">
<meta property="og:locale">
<meta property="og:image" content="http://example.com/2021/04/08/%E5%9C%A8Unity%E4%B8%AD%E4%B8%8D%E4%BD%BF%E7%94%A8%E4%BB%BB%E4%BD%95%E6%8F%92%E4%BB%B6%E5%88%B6%E4%BD%9C%E8%A7%92%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%B3%BB%E7%BB%9F/%E5%AF%B9%E8%AF%9D%E6%A1%86.png">
<meta property="og:image" content="http://example.com/2021/04/08/%E5%9C%A8Unity%E4%B8%AD%E4%B8%8D%E4%BD%BF%E7%94%A8%E4%BB%BB%E4%BD%95%E6%8F%92%E4%BB%B6%E5%88%B6%E4%BD%9C%E8%A7%92%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%B3%BB%E7%BB%9F/%E6%B3%A8%E6%84%8F.png">
<meta property="og:image" content="http://example.com/2021/04/08/%E5%9C%A8Unity%E4%B8%AD%E4%B8%8D%E4%BD%BF%E7%94%A8%E4%BB%BB%E4%BD%95%E6%8F%92%E4%BB%B6%E5%88%B6%E4%BD%9C%E8%A7%92%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%B3%BB%E7%BB%9F/%E6%8C%82%E8%BD%BD.png">
<meta property="article:published_time" content="2021-04-08T13:42:08.000Z">
<meta property="article:modified_time" content="2022-01-07T11:42:13.905Z">
<meta property="article:author" content="Karmotrine">
<meta property="article:tag" content="教程">
<meta property="article:tag" content="Unity">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/04/08/%E5%9C%A8Unity%E4%B8%AD%E4%B8%8D%E4%BD%BF%E7%94%A8%E4%BB%BB%E4%BD%95%E6%8F%92%E4%BB%B6%E5%88%B6%E4%BD%9C%E8%A7%92%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%B3%BB%E7%BB%9F/%E5%AF%B9%E8%AF%9D%E6%A1%86.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Karmotrine"><img width="96" loading="lazy" src="https://portrait.gitee.com/uploads/avatars/user/2943/8831424_karmotrine_1616074181.png!avatar100" alt="Karmotrine"><span class="site-author-status" title="不想上学">😭</span></a><div class="site-author-name"><a href="/about/">Karmotrine</a></div><span class="site-name">Utopia</span><sub class="site-subtitle">Kyrie eleison.</sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">4</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">1</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">2</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://wpa.qq.com/msgrd?v=3&amp;uin=657493712&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/karm0tr1ne" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:657493712@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.douban.com/people/191503773/" title="豆瓣" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=1376395329" title="网易云音乐" target="_blank" style="color:#C10D0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/karmotrine-32" title="知乎" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/85367843" title="哔哩哔哩动画" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-number">1.</span> <span class="toc-text">搭建对话框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD"><span class="toc-number">2.</span> <span class="toc-text">构建基础功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86txt%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E5%AF%BC%E5%85%A5%E5%88%97%E8%A1%A8"><span class="toc-number">2.1.</span> <span class="toc-text">将txt文本文件导入列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%88%97%E8%A1%A8%E5%86%85%E5%8F%B0%E8%AF%8D%E6%92%AD%E6%94%BE"><span class="toc-number">2.2.</span> <span class="toc-text">将列表内台词播放</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E4%B8%AA%E5%8F%A5%E5%AD%90%E7%9A%84%E6%92%AD%E6%94%BE"><span class="toc-number">2.2.1.</span> <span class="toc-text">单个句子的播放</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E7%AD%94%EF%BC%88bushi-%EF%BC%9A"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">常见问答（bushi)：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B4%E4%B8%AA%E5%AF%B9%E8%AF%9D%E6%96%87%E6%9C%AC%E7%9A%84%E6%92%AD%E6%94%BE"><span class="toc-number">2.2.2.</span> <span class="toc-text">整个对话文本的播放</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E7%AD%94-bushi-%EF%BC%9A"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">常见问答(bushi)：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9D%9F%E6%92%AD%E6%94%BE%E5%AF%B9%E8%AF%9D%E6%96%87%E6%9C%AC"><span class="toc-number">2.2.3.</span> <span class="toc-text">结束播放对话文本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%88%90%E5%A2%9E%E5%80%BC%E5%8A%9F%E8%83%BD%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">完成增值功能：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E8%B7%B3%E8%BF%87%E5%AF%B9%E8%AF%9D%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">3.1.</span> <span class="toc-text">实现跳过对话的功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E6%89%8B%E5%8A%A8%E6%92%AD%E6%94%BE%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">3.2.</span> <span class="toc-text">实现自动手动播放的功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5%EF%BC%9A"><span class="toc-number">4.</span> <span class="toc-text">友情链接：</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://example.com/2021/04/08/%E5%9C%A8Unity%E4%B8%AD%E4%B8%8D%E4%BD%BF%E7%94%A8%E4%BB%BB%E4%BD%95%E6%8F%92%E4%BB%B6%E5%88%B6%E4%BD%9C%E8%A7%92%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%B3%BB%E7%BB%9F/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Karmotrine"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Utopia"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">在Unity中不使用任何插件制作角色对话框系统</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2021-04-08 21:42:08" itemprop="dateCreated datePublished" datetime="2021-04-08T21:42:08+08:00">2021-04-08</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2022-01-07 19:42:13" itemprop="dateModified" datetime="2022-01-07T19:42:13+08:00">2022-01-07</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="本文字数">2.6k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="阅读时长">9m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Unity/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Unity</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E6%95%99%E7%A8%8B/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">教程</span></a><a class="tag-item" href="/tags/Unity/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Unity</span></a></span></div><div class="post-author"><div class="author-avatar"><img src="https://www.gravatar.com/avatar/6c9385ec68c559cae4e1d7a3e3b483c0?s=20&amp;d=https%3A%2F%2Fcdn.jsdelivr.net%2Fgh%2FYunYouJun%2Fcdn%2Fimg%2Favatar%2Fnone.jpg"></div><span class="author-name">Karmotrine.</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1810759765&auto=1&height=66"></iframe>

<p>在众多RPG等游戏中，对话框系统显然属于不可或缺的一部分。玩家通过对话了解剧情以及接下来的主线。可以说，<del>对话系统就是RPG游戏的灵魂（bushi</del>,而这个文章介绍的对话系统可以在无需插件并且完成对话系统基本功能的同时完成以下三点内容：</p>
<p><strong>1.剧情内容只用按照规律写在txt文件里</strong></p>
<p><strong>2.可以选择跳过，自动播放或者手动播放</strong></p>
<p><strong>3.文字会一个一个显示，而不是整句话蹦出来</strong></p>
<p>撒，那我们开始把（</p>
<h2 id="搭建对话框"><a href="#搭建对话框" class="headerlink" title="搭建对话框"></a>搭建对话框</h2><p>​        按照以往经验，对话框肯定要包括对话信息框，角色的头像和名字。然后我在此基础上还要实现自动播放，跳过，所以加了两个按钮。如果还要其它功能可以自己再加。。。我直接简单搭了一个：</p>
<p><img src="%E5%AF%B9%E8%AF%9D%E6%A1%86.png" alt="对话框" loading="lazy"></p>
<p>其中对话框主体直接在canvas的最下面加了panel，角色名称，对话内容分开来各用一个text（因为到时候要随着角色的改变而改变），并且以panel为父物体。（这个没什么难度，直接简写了）</p>
<p><strong>注意！：</strong></p>
<p>无论要怎么改，对话框物体一定要设置锚点卡在屏幕的各个角落，否则会因为屏幕尺寸发生变化而偏移！</p>
<p><img src="%E6%B3%A8%E6%84%8F.png" alt="注意" loading="lazy"></p>
<p>锚点设置方法：点击红箭头指的按钮，按住alt键，选择要固定在屏幕的哪个地点。</p>
<h2 id="构建基础功能"><a href="#构建基础功能" class="headerlink" title="构建基础功能"></a>构建基础功能</h2><p>要实现基础功能，就要通过三个流程：</p>
<p><strong>1.将txt文本文件导入列表</strong></p>
<p><strong>2.将列表内的台词依次播放，同时根据角色的转变而变换头像</strong></p>
<p><strong>3.判断结束对话并且把所有对话框组件setactive改为false</strong></p>
<p>先是声明的各种物体代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> [Header(&quot;UI组件&quot;)]</span><br><span class="line">    public Text textLabel;  //对话框的内容text</span><br><span class="line">    public GameObject SkipButton; //跳过按钮</span><br><span class="line">    public GameObject AutoButton; //自动播放按钮</span><br><span class="line">    public GameObject Log; //对话框的panel</span><br><span class="line">    public Text AutoText; //自动播放按钮的“自动播放”文本的text（用于实现自动手动切换的功能）</span><br><span class="line">    public GameObject Warning; //提醒玩家按左键继续，可要可不要</span><br><span class="line">[Header(&quot;文本文件&quot;)]</span><br><span class="line">public TextAsset textfile; //剧情文本的txt文件</span><br><span class="line">public int index; //进行到了第几句话，用于实现基础功能</span><br><span class="line">public float textSpeed = 0.05f; //每个字多久才能出现</span><br><span class="line"></span><br><span class="line">[Header(&quot;头像&quot;)]</span><br><span class="line">public GameObject A; //角色的头像以及名字</span><br><span class="line">public GameObject B; //角色的头像以及名字</span><br><span class="line">//因为我直接把名字和头像绑定为父子物体了，所以只声明了一个GameObect</span><br><span class="line"></span><br><span class="line">bool textFinished; //判断对话是否结束</span><br><span class="line">float i=0f; //判断是否为自动还是手动播放</span><br><span class="line"></span><br><span class="line">List&lt;string&gt; textList = new List&lt;string&gt;(); //将txt文件的对话内容导入列表内</span><br></pre></td></tr></table></figure>

<p>接着进unity把每个组件都挂载一下（具体是啥我在注释都写了，所以就不贴图了）</p>
<h3 id="将txt文本文件导入列表"><a href="#将txt文本文件导入列表" class="headerlink" title="将txt文本文件导入列表"></a>将txt文本文件导入列表</h3><p>在说明代码前先把txt的格式说明一下（为什么这样之后再说）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A</span><br><span class="line">换一个角色说话之前要把角色的名字单独打一行</span><br><span class="line">就像这样</span><br><span class="line">B</span><br><span class="line">这样就换成了我（</span><br><span class="line">结束的时候不需要标记什么</span><br></pre></td></tr></table></figure>



<p>先贴上代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> void GetTextFromFile(TextAsset file)</span><br><span class="line">&#123;</span><br><span class="line">     textList.Clear(); //如果不是第一次调用对话框，就需要把之前一次所有对话的列表给清空</span><br><span class="line">     index = 0; //并且把显示第几句话的index清零</span><br><span class="line">     var lineData = file.text.Split(&#x27;\n&#x27;); //把文本文件以回车分割一句句台词和角色名称</span><br><span class="line"></span><br><span class="line">     foreach (var line in lineData) </span><br><span class="line">    &#123;</span><br><span class="line">        textList.Add(line); //把一句句台词录入line列表里</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>总而言之就是：重置之前用过的台词和数据，处理文本文件，用回车键分割一句句台词，然后把台词录入列表以供对话系统使用。</p>
<p><strong>注意：</strong></p>
<p>在调用时要放在Awake函数里，因为Awake函数是一启用脚本就开始运行，而这个工序也要一经使用就开始运行。我的脚本调用是这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">void Awake()</span><br><span class="line">    &#123;</span><br><span class="line">        GetTextFromFile(textfile);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="将列表内台词播放"><a href="#将列表内台词播放" class="headerlink" title="将列表内台词播放"></a>将列表内台词播放</h3><p><em><strong>注意：看懂这段代码需要学习unity协程函数的知识，如果之前没有听过建议百度学习一下或者等我的文章更新<del>（算了我天天鸽还是别等了）</del></strong></em></p>
<h4 id="单个句子的播放"><a href="#单个句子的播放" class="headerlink" title="单个句子的播放"></a>单个句子的播放</h4><p>还是贴代码（这个代码实现的只是单个句子的播放，而不是整个对话）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">IEnumerator SetTextUI() //协程函数的标准形式</span><br><span class="line">    &#123;</span><br><span class="line">        textFinished = false; //正在播放，所以bool值为false</span><br><span class="line">        textLabel.text = &quot;&quot;; //可能上一个句子使用结束后还在text上，所以要清空</span><br><span class="line">    	switch (textList[index]) //index是指播放到了第几句，所以这是来判断当前播放到的台词</span><br><span class="line">        //用来判断是谁说出来的（所以txt要按标准写嘛（叉腰））</span><br><span class="line">    	&#123;</span><br><span class="line">        	case &quot;A\r&quot;://如果A要说话</span><br><span class="line">            	&#123;</span><br><span class="line">                	A.SetActive(true); //头像名字显示出来</span><br><span class="line">                	index++; //直接跳到下一句，这样就不会直接出现在对话框的对话里面</span><br><span class="line">                	break;</span><br><span class="line">            	&#125;</span><br><span class="line">                //如果还要写别人的话，case信息和上面一样</span><br><span class="line">        	case &quot;旁白\r&quot;: //与上面同理</span><br><span class="line">            	&#123;</span><br><span class="line">                	QingShan.SetActive(false);</span><br><span class="line">                	index++;</span><br><span class="line">                	break;</span><br><span class="line">            	&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	for (int i = 0; i &lt; textList[index].Length; i++)</span><br><span class="line">        //按照一句话的一个字慢慢来，如果没有到一句台词最后一个字的话就一直向后</span><br><span class="line">    	&#123;</span><br><span class="line">        	textLabel.text += textList[index][i]; //往之前已经打出的台词中加进新的文字</span><br><span class="line">        	yield return new WaitForSeconds(textSpeed);//等待textSpeed后继续循环</span><br><span class="line">    	&#125;</span><br><span class="line">    	textFinished = true; //如果跳出循环说明文字已经放完了，所以bool值是true</span><br><span class="line">    	index++; //这句话已经放完了，index++跳进下一句话</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中<code>yield return</code>的意思就是，在这一帧return，并且在下一帧继续开始。如果看不懂的话还是建议百度一下unity协程函数。<del>这样的话不用放进update函数里面也可以实现延时等效果。(暴论)</del></p>
<h5 id="常见问答（bushi-："><a href="#常见问答（bushi-：" class="headerlink" title="常见问答（bushi)："></a>常见问答（bushi)：</h5><p><strong>为什么判断是角色名字后不直接跳出函数，而是继续打出呢？</strong></p>
<p>因为txt里面角色名字后面一定是角色说的话而不是另一个角色的名字，所以可以直接不需要判断而进入循环。<del>同时在写txt剧情时也要注意：哪有一个角色还没讲话就出现另外一个角色的道理哼哼啊啊啊啊啊</del></p>
<p><strong>为什么角色名字后面要加/r?</strong></p>
<p>因为在windows的txt文本中，每次回车都会有\r的存在。如果要判断是不是角色名就一定要加上\r，<del>除非你不是拿windows做游戏。</del></p>
<hr>
<h4 id="整个对话文本的播放"><a href="#整个对话文本的播放" class="headerlink" title="整个对话文本的播放"></a>整个对话文本的播放</h4><p>还是先贴代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">void Update()&#123;</span><br><span class="line">	AutoText.text = &quot;自动播放&quot;; //切换自动手动播放时要用的</span><br><span class="line">    textSpeed = 0.05f; //每个字出来的间隔时0.05秒</span><br><span class="line">    if (Input.GetKeyDown(KeyCode.Mouse0) &amp;&amp; index == textList.Count)</span><br><span class="line">    &#123;</span><br><span class="line">    	EndDialogue();//如果按下鼠标左键并且播放到了最后一句的话就启动结束对话的函数</span><br><span class="line">    &#125;</span><br><span class="line">    if (Input.GetKeyDown(KeyCode.Mouse0) &amp;&amp; textFinished)</span><br><span class="line">    &#123;</span><br><span class="line">    	StartCoroutine(SetTextUI());//如果按下鼠标左键的同时一句话已经放完了，就继续启动下一句的播放</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="常见问答-bushi-："><a href="#常见问答-bushi-：" class="headerlink" title="常见问答(bushi)："></a>常见问答(bushi)：</h5><p><strong>为什么要设置一个textFinished的布尔值？</strong></p>
<p>因为如果不设置的话前面一句还没有看完下一句的台词直接来了，这样会严重影响读者的阅读体验，所以我决定直接卡死不让玩家快进。</p>
<hr>
<h4 id="结束播放对话文本"><a href="#结束播放对话文本" class="headerlink" title="结束播放对话文本"></a>结束播放对话文本</h4><p>依旧是先贴上代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public void EndDialogue()</span><br><span class="line">&#123;//把114514个对话框组件全部隐藏，代表对话已经结束了</span><br><span class="line">	gameObject.SetActive(false);</span><br><span class="line">	QingShan.SetActive(false);</span><br><span class="line">	Log.SetActive(false);</span><br><span class="line">	SkipButton.SetActive(false);</span><br><span class="line">	AutoButton.SetActive(false);</span><br><span class="line">    index = 0; //把目录调整成最开始，这样下一次开始就是从第一句播放</span><br><span class="line">    return;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样一个完整的对话就结束了。</p>
<p><em><strong>但是如何实现对话的自动手动播放，以及跳过播放呢？</strong></em></p>
<h2 id="完成增值功能："><a href="#完成增值功能：" class="headerlink" title="完成增值功能："></a>完成增值功能：</h2><h3 id="实现跳过对话的功能"><a href="#实现跳过对话的功能" class="headerlink" title="实现跳过对话的功能"></a>实现跳过对话的功能</h3><p>这活儿很简单，只要把脚本放进空物体，然后把按钮按下的脚本挂载进并选择EndDailogue函数里就可以了。</p>
<p><img src="%E6%8C%82%E8%BD%BD.png" alt="挂载" loading="lazy"></p>
<h3 id="实现自动手动播放的功能"><a href="#实现自动手动播放的功能" class="headerlink" title="实现自动手动播放的功能"></a>实现自动手动播放的功能</h3><p>这个功能其实比较简陋，因为我目前还没有尝试在每句话结束后调节时间的功能，只是把每个字播放的顺序调慢而已。（请大神轻喷）</p>
<p>还是代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if (i % 2 == 0f)//当i是偶数时，说明点了偶数按钮，就是手动播放，奇数同理</span><br><span class="line">        &#123;</span><br><span class="line">            AutoText.text = &quot;自动播放&quot;; //把按钮文本改了，因为现在是手动播放</span><br><span class="line">            textSpeed = 0.05f; </span><br><span class="line">            if (Input.GetKeyDown(KeyCode.Mouse0) &amp;&amp; index == textList.Count)</span><br><span class="line">            &#123;</span><br><span class="line">                EndDialogue();</span><br><span class="line">            &#125;</span><br><span class="line">            if (Input.GetKeyDown(KeyCode.Mouse0) &amp;&amp; textFinished)</span><br><span class="line">            &#123;</span><br><span class="line">                StartCoroutine(SetTextUI());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            AutoText.text = &quot;手动播放&quot;;</span><br><span class="line">            textSpeed = 0.15f; //把每个字出现的时长调整长了</span><br><span class="line">            if (index == textList.Count) //因为是自动播放，所以去掉了按鼠标左键的限制</span><br><span class="line">            &#123;</span><br><span class="line">                EndDialogue();</span><br><span class="line">            &#125;</span><br><span class="line">            if (textFinished) //这里也是</span><br><span class="line">            &#123;</span><br><span class="line">                StartCoroutine(SetTextUI());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> public void AutoPlay() //要把这个函数挂载进自动播放的按钮里</span><br><span class="line">    &#123;</span><br><span class="line">        i = i + 1f;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>说起来这个功能还是比较简陋，它的是否是自动手动的判定机制仅仅是判断点击按钮的次数是奇数还是偶数，按钮每次点击也只是计算点击次数的变量+1，但是它就是这么实现了？<del>就很怪</del></p>
<p><em><strong>再次提醒一下，AutoPlay函数要挂载进按钮里面，挂载方式和之前跳过对话的按钮一样，否则无法实现功能。</strong></em></p>
<hr>
<p><em><strong>就这样差不多就完成了，虽然小编也很惊奇，但是对话框系统就是这样完成了。有疑惑的小伙伴欢迎在评论区留下点赞评论吧！我们下期再见！<del>（你是营销号吗？？）</del></strong></em></p>
<h2 id="友情链接："><a href="#友情链接：" class="headerlink" title="友情链接："></a>友情链接：</h2><p><strong>大多数代码以及思想借鉴的视频：</strong><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WJ411Y71J">https://www.bilibili.com/video/BV1WJ411Y71J</a></p>
<p>(Michael真的很强，建议初学者都去康康他的视频嗷)</p>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Karmotrine.</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://example.com/2021/04/08/%E5%9C%A8Unity%E4%B8%AD%E4%B8%8D%E4%BD%BF%E7%94%A8%E4%BB%BB%E4%BD%95%E6%8F%92%E4%BB%B6%E5%88%B6%E4%BD%9C%E8%A7%92%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%B3%BB%E7%BB%9F/" title="在Unity中不使用任何插件制作角色对话框系统">http://example.com/2021/04/08/%E5%9C%A8Unity%E4%B8%AD%E4%B8%8D%E4%BD%BF%E7%94%A8%E4%BB%BB%E4%BD%95%E6%8F%92%E4%BB%B6%E5%88%B6%E4%BD%9C%E8%A7%92%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%B3%BB%E7%BB%9F/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/04/11/%E5%85%B3%E4%BA%8EUnity%E5%8D%8F%E7%A8%8B%E5%87%BD%E6%95%B0%E7%9A%84%E4%B8%AA%E4%BA%BA%E7%90%86%E8%A7%A3/" rel="prev" title="关于Unity协程函数的个人理解"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">关于Unity协程函数的个人理解</span></a></div><div class="post-nav-item"></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>若您想及时得到回复提醒，建议跳转 GitHub Issues 评论。</span><br><span>若没有本文 Issue，您可以使用 Comment 模版新建。</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2021 – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Karmotrine</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v6.0.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div><div class="live-time"><span>本博客已萌萌哒地运行</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2022-01-07T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} 天 ${passHour} 小时 ${passMinute} 分 ${passSecond} 秒`;
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><div class="aplayer no-destroy" id="aplayer" data-id="7226373375" data-server="netease" data-type="playlist" data-fixed="true" data-theme="#0078E7" data-loop="all" data-order="list" data-preload="auto" data-volume="0.7" data-mutex data-lrctype="0" data-listfolded data-listmaxheight="340px" data-storagename="metingjs"></div></div></body></html>